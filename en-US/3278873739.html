<!DOCTYPE html><html xmlns="http://www.w3.org/1999/xhtml"><head xmlns:forms="http://www.schema.de/2010/ST4/Layout/MarkupLanguage/Forms"><meta http-equiv="Content-Script-Type" content="text/javascript" /><meta http-equiv="Content-Style-Type" content="text/css" /><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge" /><meta name="generator" content="SCHEMA ST4, Bootstrap 2016 v1" /><meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1.0, maximum-scale=1.0, user-scalable=no" /><meta name="msapplication-config" content="none" /><link rel="icon" type="image/x-icon" href="../assets/ico/bruker.ico" /><link rel="stylesheet" href="../assets/css/base/01-bootstrap.min.css" /><link rel="stylesheet" href="../assets/css/base/02-jquery-tree.css" /><link rel="stylesheet" href="../assets/css/base/03-bootstrap-schema.css" /><link rel="stylesheet" href="../assets/css/base/04-jquery.mcustomscrollbar.min.css" /><link rel="stylesheet" href="../assets/css/base/05-jquery.mmenu.oncanvas.css" /><link rel="stylesheet" href="../assets/css/base/06-jquery.mmenu.schema.css" /><link rel="stylesheet" href="../assets/css/formats.css" /><title>ftnd</title></head><body id="3278873739" lang="en-US" xmlns:forms="http://www.schema.de/2010/ST4/Layout/MarkupLanguage/Forms" data-node-id="3278873739" class="" data-culture="en-US"><div class="off-canvas"><div id="off-canvas-menu" role="complementary"></div><div id="pushobj"><div class="scroll-container content-container" id="content-container"><div class="container" role="main"><ol class="breadcrumb hidden-xs"><li><a style="color:#3195CA;" href="index.html"></a></li><li><a style="color:#3195CA;" href="3278819851.html">nD Processing Commands</a></li><li>ftnd</li></ol><h1 class="heading" style="color:black;">ftnd</h1><div class="metalist"></div><h2 class="subheading">NAME</h2><p>ftnd - nD processing including Fourier transform (≥ 3D) <span class=".index-entry" id="ID0EADBQ"></span></p><h2 class="subheading">DESCRIPTION</h2><p>The command <strong>ftnd</strong> processes nD data performing fid baseline correction, linear prediction, window multiplication, Fourier transform and phase correction. The command automatically recognizes the data dimensionality and handles data of dimension ≥3D. In TopSpin, <strong>ftnd</strong> has been tested by Bruker on 3D, 4D, 5D and 6Ddata. Note that 3D data can also be processed with the conventional commands <strong>tf3</strong>, <strong>tf2</strong>, <strong>tf1</strong> and <strong>ft3d</strong>. </p><p>As an example, <strong>ftnd</strong> is described here for a 4D dataset. It takes the following three arguments:</p><p><strong>&lt;direction&gt;</strong> </p><p>the direction(s) to be processed. Allowed values are:</p><p>0 : all directions, in the order defined by AQSEQ</p><p>4321, 4312, 4231, 4213, 4132, 4123 : all directions in specified order</p><p>4, 3, 2, or 1 : F4, F3, F2 or F1, respectively. </p><p><strong>&lt;procno&gt;</strong> </p><p>Output procno of the processed data. Optional argument, normally unused. In special cases, however, the data cannot be processed in-place, and must be stored in a different procno. <strong>ftnd </strong>will then prompt you for an output procno.</p><p><strong>dlp</strong> </p><p>Delayed linear prediction. Optional argument, only applicable when all directions are processed. This argument ensures that when linear prediction is performed in a certain direction, all other directions are already Fourier transformed (see below).</p><p>If the arguments are not specified on the command line, <strong>ftnd</strong> will normally only prompt you for the direction. The output procno is only prompted for if inplace operation is not possible. </p><p>Here are some example of specifying arguments on the command line:</p><p><strong>ftnd</strong> <strong>0</strong></p><p>Process the data in all directions in the order defined by the acquisition status parameter AQSEQ</p><p><strong>ftnd</strong> <strong>4 </strong></p><p>Process data in direction F4</p><p><strong>ftnd</strong> <strong>4312 999 </strong></p><p>Process the data in all directions, in the order F4-F3-F1-F2 and store the result in procno 999</p><p><strong>ftnd</strong> <strong>0 dlp</strong></p><p>Process the data in all directions, in the order defined by AQSEQ, performing delayed linear prediction according to ME_MOD and NCOEF. </p><p>Missing arguments are prompted for, except for the <strong>dlp</strong> argument. Note that for the first argument, the direction, only the allowed directions are displayed and the next logical direction is suggested. The figure below shows the dialog opened by <strong>ftnd</strong> on a 4D dataset that has already been processed in F4 and F3.</p><p> </p><figure class="img_50"><img src="../Images/png/18014398912536075__Web.png" width="375" height="208" /></figure><p> </p><h2 class="subheading">Extract 1D, 2D or 3D data from 4D, 5D,... processed data.</h2><p>To view the result of 4D processing, open the dataset (<em>procno</em>) where the processed data are stored and read a 3D-cube, 2D-plane or 1D trace. This can be done with the commands <strong>rcb</strong>, <strong>rpl</strong> and <strong>rtr</strong>, respectively. These commands automatically switch to the destination dataset showing the 3D, 2D or 1D dataset, respectively (see the description of these commands for more information). Furthermore, you can extract positive, negative or sum cube projections with the commands <strong>projcbp</strong>, <strong>projcbn</strong> and <strong>sumcb</strong>, respectively. Similarly, you can extract plane projections with the commands <strong>projplp</strong>, <strong>projpln</strong> and <strong>sumpl</strong>, respectively.</p><p>Instead of processing the entire 4D dataset and reading a certain plane or trace, you can also process single 2D-planes or 1D fids of the 4D raw data. To process a plane, just enter <strong>xfb</strong>, <strong>xf2</strong> or <strong>xtrf</strong> and specify the requested plane axis orientation, plane number and output<em> procno</em>. To process a trace, just enter a 1D processing command like <strong>ft</strong> or <strong>trf</strong> and specify the requested fid number and output<em> procno</em>. Obviously, 1D/2D processing commands can also be used to further process or reprocess traces/planes or processed 4D data. For example:</p><ol class="list"><li value="1">Open a 4D dataset</li><li value="2"><strong>ftnd</strong> <strong>4 </strong>-<strong> </strong>Perform 4D processing in the F4 direction</li><li value="3"><strong>rpl</strong> <strong>34</strong> <strong>1</strong> <strong>999 </strong>-<strong> </strong>Read F3-F4 plane 1 and store it in<em> procno</em> 999. Note that the plane is stored as a F2-processed 2D dataset. </li><li value="4"><strong>xf1</strong> - Perform 2D processing in the F1-direction.</li></ol><h2 class="subheading">Processing the four directions in separate steps</h2><p>Normally, <strong>ftnd</strong> with the argument <strong>0</strong> or one of the arguments 4321, 4312, .. etc. to process all directions. In some cases, you may want to process the different directions in individual steps and perform the sequence <strong>ftnd</strong> <strong>4</strong>, <strong>ftnd</strong> <strong>3</strong>, .. etc. The first direction to be processed must be F4, the other three directions can be processed in any order. Note that every order in which the data are processed in F3, F2 an and F1 gives the same result, unless linear prediction is done (ME_mod and NCOEF ≠ 0) </p><h2 class="subheading">Delayed linear prediction</h2><p>Linear prediction is a valuable method for improving the resolution of nD data with small TD values and often truncated FIDs. The effect of linear prediction in one direction can, however, be distorted by modulations introduced by other, untransformed, directions. The <strong>dlp</strong> argument allows to perform linear prediction in a certain direction while all other directions have already been Fourier transformed. Let’s take an example to see how this works. Suppose you have a 4D dataset with acquisition order 4321 (parameter AQSEQ), which you want to processed in all 4 directions including Window Multiplication (WM) and Fourier transform (FT). Furthermore, you want to increase the resolution with linear prediction (LP) in the third (F2) and fourth (F1) direction. As such, you have set the parameters WDW, and, in F2 and F1, ME_mod and NCOEF, to appropriate values. If you use the command <strong>ftnd 0</strong> the following happens: </p><ul class="list"><li value="1">Processing in F4 (WM - FT)</li><li value="2">Processing in F3 (WM - FT</li><li value="3">Processing in F2 (LP - WM - FT</li><li value="4">Processing in F1 (LP - WM - FT</li></ul><p>So when linear prediction is done in F2, data have not been Fourier transformed yet in F1, which can cause distortions.</p><p>If, however, you use the command <strong>ftnd</strong> <strong>0</strong> <strong>dlp</strong> for delayed linear prediction, the following happens:</p><ul class="list"><li value="1">Processing in F4 (WM - FT) </li><li value="2">Processing in F3 (WM - FT) </li><li value="3">Processing in F2 (FT) </li><li value="4">Processing in F1 (LP - WM - FT) </li><li value="5">Processing in F2 (IFT - inverse Fourier transform, including Hilbert Transform to create temporary imaginary data)</li><li value="6">Processing in F2 (LP - WM - FT) </li></ul><p>Now when linear prediction is done in F2, the data are Fourier transformed in F1 (and all other directions). For the F1 direction, linear prediction does not have to be delayed because F1 is the last direction being processed. Note that <strong>ftnd</strong> also performs fid baseline correction and spectrum phase correction if the parameters BC_mod and PH_mod, respectively, are set.</p><p>Delayed linear prediction can also be performed in two steps. The command: </p><p><strong>ftnd</strong> <strong>0</strong> <strong>dlp</strong> (with F2-ME_mod ≠ 0 and NCOEF ≠0)</p><p>is equivalent with the command sequence:</p><ul class="list"><li value="1"><strong>ftnd</strong> <strong>0</strong> (with F2-ME_mod = 0) and WDW = 0</li><li value="2"><strong>lpnd</strong> <strong>2</strong> (with F2-ME_mod ≠ 0, NCOEF ≠ 0 and WDW ≠ 0) </li></ul><h2 class="subheading">In-place operation</h2><p>Normally, <strong>ftnd</strong> can perform an in-place operation, which means the processed data are stored in the current <em>procno</em>. In special cases, however, in-place operation is not possible and the processed data must be stored in a different <em>procno</em>. <strong>ftnd</strong> will prompt the user for the output <em>procno</em>. When processing is finished, the display will automatically change to the destination PROCNO. </p><p>Whether or not in-place operation is possible depends on the direction being processed and the zero-filling conditions. In-place operation is done:</p><ul class="list"><li value="1">In the first direction: always</li><li value="2">In the second direction: always as long as all directions are processed with one command, e.g. with <strong>ftnd 0</strong>.<strong> </strong></li><li value="3">In the third, fourth etc. directions: if at least single zero filling (SI ≥ TD and (STSI = 0 or STSI ≥ TD)). </li></ul><p>Note that if a <em>procno</em> is specified on the command line, it is used, i.e. the processed data of the last two directions are stored there.</p><p>Restrictions nD processing</p><p>The command <strong>ftnd</strong> has the following restrictions:</p><ul class="list"><li value="1">Raw and processed data have the same dimensionality, i.e. the values of the status parameters PARMODE and PPARMOD must be the same. Note that 2D processing commands like <strong>xfb</strong> also work on datasets with different raw and processed data dimensionality, e.g. 3D raw and 2D processed data.</li><li value="2">If dimension &gt; 3 and the acquisition mode (acquisition status parameter FnMODE) is QF in one direction, it must be QF in all directions. In other words, you cannot process mixed single detection/hypercomplex data for dimension &gt; 3.</li><li value="3">For data of dimension ≥ 5D, only the natural acquisition order (AQSEQ = 0) is supported.</li><li value="4">Simultaneous echo-antiecho not supported; the acquisition status parameter FnMODE must not be echo-antiecho in more than 1 direction.</li></ul><p>Note that the values of parameters which use a predefined list are stored as integers. The first value of the list is always stored as 0, the second value as 1 etc. The table below shows the values of the parameter PH_mod as an example: </p><table class="table tabletype-framed table-scaled"><colgroup><col style="width: 3.00cm;"></col><col style="width: 5.47cm;"></col></colgroup><tbody><tr><td><p class="text-left">Parameter value</p>
</td><td><p class="text-left">Integer stored in the proc(s) file</p>
</td></tr><tr><td><p class="text-left">no </p>
</td><td><p class="text-left">0</p>
</td></tr><tr><td><p class="text-left">pk</p>
</td><td><p class="text-left">1</p>
</td></tr><tr><td><p class="text-left">mc</p>
</td><td><p class="text-left">2</p>
</td></tr><tr><td><p class="text-left">ps</p>
</td><td><p class="text-left">3</p>
</td></tr></tbody></table><p> </p><h2 class="subheading">INPUT PARAMETERS </h2><h2 class="subheading">F4, F3, F2 and F1 parameters</h2><p>Set by the user with <strong>edp</strong> or by typing <strong>si</strong>, <strong>stsr</strong> etc.:</p><p>SI - size of the processed data</p><p>STSR - strip start: first output point of strip transform</p><p>STSI - number of output points of strip transform</p><p>TDeff - number of raw data points to be used for processing </p><p>TDoff - first point of the FID used for processing (default 0)</p><p>FCOR - first (FID) data point multiplication factor (0.0-2.0, default 0.5)</p><p>REVERSE - flag indicating to reverse the spectrum</p><p>BC_mod - FID baseline correction mode</p><p>BCFW - filter width for BC_mod = sfil or qfil</p><p>COROFFS - correction offset for BC_mod = spol/qpol or sfil/qfil</p><p>ME_mod - FID linear prediction mode</p><p>NCOEF - number of linear prediction coefficients </p><p>LPBIN - number of points for linear prediction </p><p>TDoff - number of raw data points predicted for ME_mod = LPb*</p><p>WDW - FID window multiplication mode</p><p>LB - Lorentzian broadening factor for WDW = em or gm</p><p>GB - Gaussian broadening factor for WDW = gm, sinc or qsinc</p><p>SSB - Sine bell shift for WDW = sine, qsine, sinc or qsinc</p><p>TM1, TM2 - limits of the trapezoidal window for WDW = trap</p><p>PH_mod - phase correction mode</p><p>PHC0 - zero order phase correction value for PH_mod = pk</p><p>PHC1 - first order phase correction value for PH_mod = pk</p><p>Set by the acquisition, can be viewed with <strong>dpa</strong> or <strong>s</strong> <strong>aq_mod</strong> etc.:</p><p>TD - time domain; number of raw data points</p><h2 class="subheading">F4 parameters</h2><p>Set by the user with <strong>edp</strong> or by typing <strong>aqorder</strong>, <strong>pknl</strong> etc.:</p><p>AQORDER - Acquisition order</p><p>PKNL - group delay compensation (Avance) or filter correction (A*X)</p><p>Set by the acquisition, can be viewed with <strong>dpa</strong> or <strong>s</strong> <strong>aq_mod</strong> etc.:</p><p>AQ_mod - acquisition mode (determines the status FT_mod)</p><p>AQSEQ - acquisition sequence (3-2-1 or 3-1-2)</p><p>BYTORDA - byteorder or the raw data</p><p>NC - normalization constant</p><h2 class="subheading">F3, F2 and F1 parameters</h2><p>Set by the acquisition, can be viewed with <strong>dpa</strong> or by typing <strong>s</strong> <strong>fnmode</strong> etc.:</p><p>FnMODE - Fourier transform mode</p><h2 class="subheading">OUTPUT PARAMETERS </h2><h2 class="subheading">F4, F3, F2 and F1</h2><p>Can be viewed with <strong>dpp</strong> or by typing <strong>s</strong> <strong>si</strong>, <strong>s</strong> <strong>stsi</strong> etc.:</p><p>SI - size of the processed data</p><p>STSR - strip start: first output point of strip transform</p><p>STSI - strip size: number of output points of strip transform</p><p>TDeff - number of raw data points that were used for processing </p><p>TDoff - first point of the FID used for processing (default 0)</p><p>XDIM - subcube size</p><p>FT_mod - Fourier transform mode</p><p>FTSIZE - Fourier transform size</p><h2 class="subheading">F4 parameters</h2><p>Can be viewed with <strong>dpp</strong> or by typing <strong>s</strong> <strong>si</strong>, <strong>s</strong> <strong>tdeff</strong> etc.:</p><p>AQORDER - Acquisition order</p><p>YMAX_p - maximum intensity of the processed data</p><p>YMIN_p - minimum intensity of the processed data</p><p>S_DEV - standard deviation of the processed data</p><p>NC_proc - intensity scaling factor</p><p>BYTORDP - byte order of the processed data</p><h2 class="subheading">F3, F2 and F1 parameters</h2><p>Can be viewed with <strong>dpp</strong> or by typing <strong>s mc2</strong> etc.:</p><p>MC2 - Fourier transform mode</p><h2 class="subheading">INPUT FILES</h2><h2 class="subheading">For 4D data:</h2><p><em>&lt;dir&gt;/data/&lt;user&gt;/nmr/&lt;name&gt;/&lt;expno&gt;/</em></p><p><em>ser</em> - raw data</p><p><em>acqus</em> - F4 acquisition status parameters</p><p><em>acqu2s</em> - F3 acquisition status parameters</p><p><em>acqu3s</em> - F2 acquisition status parameters</p><p><em>acqu4s</em> - F1 acquisition status parameters</p><p><em>&lt;dir&gt;/data/&lt;user&gt;/nmr/&lt;name&gt;/&lt;expno&gt;/pdata/&lt;procno&gt;/</em></p><p><em>proc</em> - F4 processing parameters</p><p><em>proc2</em> - F3 processing parameters</p><p><em>proc3</em> - F2 processing parameters</p><p><em>proc4</em> - F1 processing parameters</p><p>For 3D data <em>proc4s</em> does not exist. For data of dimension n where n ≥ 5 the additional files proc5,...,etc. exist. </p><h2 class="subheading">OUTPUT FILES</h2><h2 class="subheading">For 4D data:</h2><p><em>&lt;dir&gt;/data/&lt;user&gt;/nmr/&lt;name&gt;/&lt;expno&gt;/pdata/&lt;procno&gt;/</em></p><p><em>4rrrr</em> - processed 4D data</p><p><em>procs</em> - F4 processing status parameters</p><p><em>proc2s</em> - F3 processing status parameters</p><p><em>proc3s</em> - F2 processing status parameters</p><p><em>proc4s</em> - F1 processing status parameters</p><p>For 3D data, the output data file is <em>3rrr</em> whereas <em>proc4s</em> does not exist. For data of dimension n where n ≥ 5, processed data files are named <em>nr</em> and <em>ni</em>, e.g. <em>5r</em>, <em>5i</em>, <em>6r</em>, <em>6i</em> etc. and the additional files proc5s,..., etc. exist.</p><h2 class="subheading">SEE ALSO</h2><p><a style="color:#3195CA;" href="3278837899.html">absnd</a>, <a style="color:#3195CA;" href="3278842379.html">lpnd</a>, <a style="color:#3195CA;" href="3278846859.html">pknd</a>, <a style="color:#3195CA;" href="3278851339.html">projcbp, projcbn, sumcb</a>, <a style="color:#3195CA;" href="3277544971.html">projplp, projpln, sumpl</a></p><div class="image"></div></div><div class="container"><footer><p class="text-muted">@ Bruker Corporation 2023</p></footer></div></div><div class="schema-navbar" id="navbar" role="navigation"><button class="schema-navbar-toggle visible-sm visible-xs" id="sidebar-toggle"><span class="schema-glyph schema-glyph-menu"></span></button><a class="schema-navbar-brand" href="index.html"><img class="schema-navbar-logo" src="../assets/img/logo_white.svg" /></a><button class="btn btn-default dropdown-toggle schema-navbar-toggle mobile-hidden-xs mobile-hidden-sm" style="margin-top:20px;" id="language-toggle" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span class="schema-glyph schema-glyph-more_vert" style="top:0;"></span></button><ul class="dropdown-menu" id="language-dropdown"><li class="dropdown-header hidden-md hidden-lg"></li><li class="hidden-md hidden-lg"><a href="index.html">Home</a></li><li class="dropdown-header">Language</li><li class="langMenuItem checked" data-value="en-US"><a href="../en-US/3278873739.html">us-english</a></li></ul><div id="navbar-search"><form class="schema-navbar-search hidden-xs pull-right" role="search" action="search.html"><input type="text" name="q" autocomplete="search2662718347" placeholder="Search" results="10" /></form></div><ul class="navbar-structure-pages hidden-sm hidden-xs "><li class="schema-home-text"><a href="index.html">Home</a></li></ul><button class="navbar-toggle schema-navbar-toggle visible-xs" data-toggle="collapse" data-target="#search-collapse"><span class="schema-glyph schema-glyph-search"></span></button><form class="collapse hidden-sm hidden-md hidden-lg" id="search-collapse" role="search" action="search.html"><input type="text" name="q" autocomplete="search2662718347" placeholder="Search" results="10" /></form></div></div></div><script type="text/javascript" charset="utf-8" src="js/treedata.json"></script><script src="../assets/js/00-jquery.min.js"></script><script src="../assets/js/01-bootstrap.min.js"></script><script src="../assets/js/02-modernizr.custom.js"></script><script src="../assets/js/03-jquery-tree.js"></script><script src="../assets/js/04-jquery.mmenu.oncanvas.min.js"></script><script src="../assets/js/05-jquery.mcustomscrollbar.min.js"></script><script src="../assets/js/06-jquery-scrollbars.min.js"></script><script src="../assets/js/18-schema-common-core.min.js"></script><script src="../assets/js/19-schema-common-search.js"></script><script src="../assets/js/20-bootstrap-schema.js"></script></body></html>